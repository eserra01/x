<?xml version="1.0" encoding="utf-8"?>
<odoo>
<!-- ##################################### -->
<!-- Vista de formulario para activaciones -->
<!-- ##################################### -->

  <record id="activation_form_view" model="ir.ui.view">
    <field name="name">activation.form.view</field>
    <field name="type">form</field>
    <field name="model">pabs.contract</field>
    <field name="arch" type="xml">
      <form>
        <header>
          <field name="captured" invisible="1"/>
          <field name="contract_status" invisible="1"/>
          <field name="type_view" invisible="1"/>
          <field name="state" widget="statusbar" statusbar_visible="actived,precontract,contract" readonly="1"/>
        </header>
        <sheet>
          <!--<div class="oe_button_box" name="button_box">
            <button type="object" name="action_cancel" class="oe_stat_button" icon="fa-ban" attrs="{'invisible' : ['|',('state','!=','contract'),('contract_status','=','inactive')]}">
              <span>Cancelar Contrato</span>
            </button>
            <button type="object" name="action_active" class="oe_stat_button" icon="fa-check" attrs="{'invisible' : ['|',('contract_status','=','active'),('state','=',False)]}">
              <span>Activar Contrato</span>
            </button>
          </div>
          <widget name="web_ribbon" title="Cancelado" bg_color="bg-danger" attrs="{'invisible': ['|',('contract_status', '=', 'active'),('state','=',False)]}"/>-->
          <group string="Alta de afiliado">
            <group>
              <field name="agent_id" class="oe_inline"/>
              <label for="lot_id"/>
              <h2>
                <field name="lot_id" class="oe_inline" default_focus="1"/>
              </h2>
              <field name="employee_id" attrs="{'invisible' : [('employee_id','=',False)], 'readonly' : [('employee_id','!=',False)]}"/>
              <field name="salary_scheme" invisible="1"/>
            </group>

            <group attrs="{'invisible' : [('activation_code','=',False)]}">
              <label for="activation_code"/>
              <h1>
                <field name="activation_code" readonly="1"/>
              </h1>
            </group>

            <group attrs="{'invisible' : [('salary_scheme','=',False)]}">
              <field name="payment_scheme_id" widget="selection" 
                attrs="{'readonly' : ['|',('captured','=',True),('state','!=',False)],
                        'required' : [('salary_scheme','=',True)]
                }"/>
            </group>
          </group>

          <!-- Grupo de datos de afiliado y domicilio -->
          <group>
            <group string="Datos del afiliado">
              <field name="full_name" invisible="1"/>
              <field name="partner_name" attrs="{'readonly':['|',('captured','=',True),('state','!=',False)]}"/>
              <field name="partner_fname" attrs="{'readonly':['|',('captured','=',True),('state','!=',False)]}"/>
              <field name="partner_mname" attrs="{'readonly':['|',('captured','=',True),('state','!=',False)]}"/>
              <field name="birthdate" attrs="{'readonly':['|',('captured','=',True),('state','!=',False)]}"/>
              <field name="phone" widget="phone" attrs="{'readonly':['|',('captured','=',True),('state','!=',False)]}"/>
              <field name="vat" readonly="1"/>
            </group>

            <group string='Domicilio'>
              <field name="municipality_id" attrs="{'readonly':['|',('captured','=',True),('state','!=',False)]}"/>
              <field name="neighborhood_id" domain="[('municipality_id','=',municipality_id)]" attrs="{'readonly':['|',('captured','=',True),('state','!=',False)]}"/>
              <field name="street_name" attrs="{'readonly':['|',('captured','=',True),('state','!=',False)]}"/>
              <field name="street_number" attrs="{'readonly':['|',('captured','=',True),('state','!=',False)]}"/>
              <field name="between_streets" attrs="{'readonly':['|',('captured','=',True),('state','!=',False)]}"/>
              <field name="comments" attrs="{'readonly':['|',('captured','=',True),('state','!=',False)]}"/>
              <field name="new_entry" attrs="{'readonly':['|',('captured','=',True),('state','!=',False)]}"/>
            </group>
          </group>

        </sheet>
        <div class="oe_chatter">
          <field name="message_follower_ids" widget="mail_followers"/>
          <field name="activity_ids" widget="mail_activity"/>
          <field name="message_ids" widget="mail_thread"/>
        </div>
      </form>
    </field>
  </record>

  <!-- Termina vista de formulario para activaciones -->

  <!-- Vista de lista para activaciones -->

  <record id="activation_tree_view" model="ir.ui.view">
    <field name="name">activation.tree.view</field> 
    <field name="type">tree</field>
    <field name="model">pabs.contract</field>
    <field name="arch" type="xml">          
      <tree>
        <field name="lot_id"/>
        <field name="name"/>
        <field name="partner_name"/>
        <field name="partner_fname"/>
        <field name="partner_mname"/>
        <field name="state"/>
      </tree>
    </field>
  </record>

  <!-- Termina vista de lista para activaciones -->

  <!-- Action de activaciones -->
  <record id="activation_action" model="ir.actions.act_window">
    <field name="name">Activaciones</field>
    <field name="res_model">pabs.contract</field>
    <field name="view_mode">form</field>
    <field name="domain">[('state','=','reqactive')]</field>
    <field name="context">{'default_type_view' : 'activation'}</field>
  </record>

  <!-- Llamado de vista de lista en el action principal -->
  <record id="activation_form_view_action" model="ir.actions.act_window.view">
    <field name="sequence" eval="1"/>
    <field name="view_mode">form</field>
    <field name="view_id" ref="pabs_custom.activation_form_view"/>
    <field name="act_window_id" ref="pabs_custom.activation_action"/>
  </record>

<!-- ##################################### -->
<!-- Formulario de precontratos -->
<!-- ##################################### -->
  <record id="precontract_form_view" model="ir.ui.view">
    <field name="name">contract.form.view</field>
    <field name="type">form</field>
    <field name="model">pabs.contract</field>
    <field name="arch" type="xml">
      <form create="false" edit="false" delete="false" duplicate="false">

        <header>
          <field name="allow_create" invisible="1"/>
          <field name="type_view" invisible="1"/>
          <field name="captured" invisible="1"/>
          <field name="contract_status" invisible="1"/>
          <button type="object" name="create_contract" string="Crear Contrato" class="btn-primary" attrs="{'invisible' : [('allow_create','=',False),('state','not in',('actived','precontract','cancel'))]}"/>
          <field name="state" widget="statusbar" statusbar_visible="reqactive,precontract,contract" readonly="1"/>
        </header>

        <sheet>
          <!--<div class="oe_button_box" name="button_box">
            <button type="object" name="action_cancel" class="oe_stat_button" icon="fa-ban" attrs="{'invisible' : ['|',('state','!=','contract'),('contract_status','=','inactive')]}">
              <span>Cancelar Contrato</span>
            </button>
            <button type="object" name="action_active" class="oe_stat_button" icon="fa-check" attrs="{'invisible' : ['|',('contract_status','=','active'),('state','=',False)]}">
              <span>Activar Contrato</span>
            </button>
          </div>
          <widget name="web_ribbon" title="Cancelado" bg_color="bg-danger" attrs="{'invisible': ['|',('contract_status', '=', 'active'),('state','=',False)]}"/>-->
          <group>
            <group string="Alta de contrato">
              <span attrs="{'invisible' : ['|',('name','=',False),('name','=', 'Nuevo Contrato')], 'readonly' : [('name','!=',False)]}">
                <h2><label for="name" string="Contrato"/></h2>
                <h1>
                  <field name="name" readonly="1"/>
                </h1>
              </span>
              <br/>
              <label for="lot_id"/>
              <h2>
                <field name="lot_id" class="oe_inline"/>
              </h2>
              <field name="invoice_date" attrs="{'invisible' : [('lot_id','=',False)], 'readonly' : [('state','=','contract')]}" required="True"/>
              <field name="employee_id" attrs="{'invisible' : [('lot_id','=',False)], 'readonly' : [('state','=','contract')]}" readonly="True"/>
              <field name="payment_scheme_id" attrs="{'invisible' : [('lot_id','=',False)], 'readonly' : [('state','=','contract')]}" required="True"/>
            </group>

            <group string="Datos de inversión inicial" attrs="{'invisible' : [('lot_id','=',False)]}"  col="4">
                <field name="initial_investment" widget="monetary" readonly="True" class="oe_inline" colspan="4"/>
                <field name="comission" widget="monetary" readonly="True" class="oe_inline" colspan="4"/>
                <field name="amount_received" widget="monetary" readonly="True" class="oe_inline" colspan="4"/>
                <field name="stationery" widget="monetary" readonly="True" class="oe_inline" colspan="4"/>
                <field name="excedent" widget="monetary" readonly="True" class="oe_inline" colspan="4"/>
                <field name="investment_bond" widget="monetary" readonly="True" class="oe_inline" colspan="4"/>
                <field name="activation_code" attrs="{'invisible' : [('lot_id','=',False)], 'readonly' : [('state','=','contract')]}" readonly="True" colspan="4"/>
                <field name="name_service" attrs="{'invisible' : [('lot_id','=',False)]}" colspan="2"/>
                <field name="product_price" attrs="{'invisible' : [('lot_id','=',False)]}" colspan="2"/>
            </group>
          </group>

          <group attrs="{'invisible' : [('lot_id','=',False)]}">
            <group string="Datos del Cliente" >
              <field name="partner_name" attrs="{'required' : [('state','=','precontract')], 'readonly' : [('state','=','contract')]}"/>
              <field name="partner_fname" attrs="{'readonly' : [('state','=','contract')]}"/>
              <field name="partner_mname" attrs="{'readonly' : [('state','=','contract')]}"/>
              <field name="birthdate" attrs="{'readonly' : [('state','=','contract')]}"/>
            </group>

            <group string="Datos del contrato">
              <field name="way_to_payment" attrs="{'required' : [('state','=','precontract')], 'readonly' : [('state','=','contract')]}"/>
              <field name="payment_amount" attrs="{'required' : [('state','=','precontract')], 'readonly' : [('state','=','contract')]}"/>
              <field name="date_first_payment" attrs="{'required' : [('state','=','precontract')], 'readonly' : [('state','=','contract')]}"/>
              <field name="comments"/>
            </group>
          </group>
          
          <group attrs="{'invisible' : [('lot_id','=',False)]}">
              <group string="Domicilio de casa">
                <field name="street_name" attrs="{'required' : [('state','=','precontract')], 'readonly' : [('state','=','contract')]}"/>
                <field name="street_number" attrs="{'required' : [('state','=','precontract')], 'readonly' : [('state','=','contract')]}"/>
                <field name="municipality_id" attrs="{'required' : [('state','=','precontract')], 'readonly' : [('state','=','contract')]}"/>
                <field name="neighborhood_id" attrs="{'required' : [('state','=','precontract')], 'readonly' : [('state','=','contract')]}" domain="[('municipality_id','=',municipality_id)]"/>
                <field name="between_streets" attrs="{'readonly' : [('state','=','contract')]}"/>
                <field name="phone" widget="phone" attrs="{'readonly' : [('state','=','contract')]}"/>
              </group>

              <group string='Domicilio de cobro'>
                <field name="street_name_toll" attrs="{'required' : [('state','=','precontract')], 'readonly' : [('state','=','contract')]}"/>
                <field name="street_number_toll" attrs="{'required' : [('state','=','precontract')], 'readonly' : [('state','=','contract')]}"/>
                <field name="toll_municipallity_id" attrs="{'required' : [('state','=','precontract')], 'readonly' : [('state','=','contract')]}"/>
                <field name="toll_colony_id"  attrs="{'required' : [('state','=','precontract')], 'readonly' : [('state','=','contract')]}" domain="[('municipality_id','=',toll_municipallity_id)]"/>
                <field name="between_streets_toll" attrs="{'readonly' : [('state','=','contract')]}" />
                <field name="phone_toll" attrs="{'readonly' : [('state','=','contract')]}"/>
              </group>       
          </group>

        </sheet>

        <div class="oe_chatter">
          <field name="message_follower_ids" widget="mail_followers"/>
          <field name="activity_ids" widget="mail_activity"/>
          <field name="message_ids" widget="mail_thread"/>
        </div>
        <footer>
        </footer>
      </form>
    </field>
  </record>

  <!-- Action de menú de Pre-contratos -->
  <record id="precontract_action" model="ir.actions.act_window">
    <field name="name">Pre-contratos</field>
    <field name="res_model">pabs.contract</field>
    <field name="view_mode">form</field>
    <field name="domain">[('state','=','precontract')]</field>
    <field name="context">{'default_type_view' : 'precontract'}</field>
    <field name="target">inline</field>
  </record>

  <!-- Llamado de vista de formulario en el action principal -->
  <record id="precontract_form_view_action" model="ir.actions.act_window.view">
    <field name="sequence" eval="1"/>
    <field name="view_mode">form</field>
    <field name="view_id" ref="pabs_custom.precontract_form_view"/>
    <field name="act_window_id" ref="pabs_custom.precontract_action"/>
  </record>

<!-- ############################## -->
<!-- Vista de Contratos por perfil -->
<!-- ############################## -->

  <!-- Documentación: perfiles
    Perfil secretarias:
      •	Consulta
      •	Estado de cuenta

    Perfil call center:
      •	Agregar comentarios
      •	Activar e inactivar contratos
      •	Modificar y agregar direcciones de contacto

    Perfil contratos:
      •	Crear contratos
      •	Modificación de nombre
      •	Modificar asistente social
      •	Activar e inactivar contrato
      •	Agregar comentarios
      •	Impresión de carnet de pago
      •	Reportes

    Perfil cobranza:
      •	Activar e inactivar contratos
      •	Modificación de forma de pago (semanal, quincenal, mensual)
      •	Modificación de monto de pago
      •	Agregar o modificar direcciones
      •	Impresión de carnet de pago
      •	Reportes

    Perfil enrutamiento:
      •	Modificación de direcciones
      •	Asignar o modificar cobrador
      •	Impresión de carnet de pago
      •	Reportes

    Perfil gerencial:
      •	Activar e inactivar contratos
      •	Modificación de forma de pago (semanal, quincenal, mensual)
      •	Modificación de monto de pago
      •	Agregar o modificar direcciones
      •	Asignar o modificar cobrador
      •	Reportes
   -->

<!-- ####################################### -->
<!-- Formulario de contratos (ADMINISTRADOR) -->
<!-- ####################################### -->
  <record id="contract_form_view" model="ir.ui.view">
    <field name="name">contract.form.view</field>
    <field name="type">form</field>
    <field name="model">pabs.contract</field>
    <field name="arch" type="xml">
       <form create="0" delete="false" duplicate="false">
        <header>
          <field name="captured" invisible="1"/>
          <field name="contract_status" invisible="1"/>
          <field name="allow_edit" invisible="1"/>
          <field name="state" widget="statusbar" statusbar_visible="reqactive,precontract,contract" readonly="1" invisible ="1"/>
         
        </header>
        <sheet>       
          <group attrs="{'invisible' : [('lot_id','=',False)]}"> 
            <group string="Datos del contrato" >
              <field name="name" class="oe_inline" readonly="1"/>
              <!-- attrs="{'readonly': [('allow_edit','=',False)]}" -->

              <!-- Estatus -->
              <field name="contract_status_item" required="1"/>
              <field name="contract_status_reason" domain="[('status_id', '=', contract_status_item)]" required="1"/>
              <field name="contract_status_name" invisible="1"/>
              <field name="reactivation_date" attrs="{'invisible': [('contract_status_name','!=','SUSP. TEMPORAL')], 'required': [('contract_status_name','=','SUSP. TEMPORAL')]}"/>
              <field name="date_of_last_status" readonly="1"/>
              <!-- Fin Estatus -->
              
              <!-- Nombre -->
              <field name="full_name" string="Titular"/>

              <label for="partner_name" string="Nuevo nombre" class="oe_edit_only" /> 
              <field name="partner_name" class="oe_edit_only" nolabel="1"/>

              <label for="partner_fname" string="Nuevo apellido paterno" class="oe_edit_only" /> 
              <field name="partner_fname" class="oe_edit_only" nolabel="1"/>

              <label for="partner_mname" string="Nuevo apellido materno" class="oe_edit_only" /> 
              <field name="partner_mname" class="oe_edit_only" nolabel="1"/>
              <!-- Fin nombre -->
              
              <field name="invoice_date" readonly="1"/>
              <field name="name_service" string="Nombre del plan" readonly="1"/>
              <field name="service_detail"/>
            </group>

            <group string="Datos de cobranza">
              <field name="debt_collector" domain="[('job_id','=','COBRADOR')]"/>
              <field name="way_to_payment" />
              <field name="payment_amount" />
              <field name="days_without_payment" readonly="1"/>
              <field name="late_amount"  readonly="1"/>
              <field name="date_first_payment" />
              <field name="contract_expires" readonly="1"/>
              <field name="product_price" readonly="1"/> 
              <field name="balance" readonly="1"/>
              <field name="paid_balance" readonly="1"/>

              <!-- Nuevo comentario -->
              <label for="new_comment" class="oe_edit_only" /> 
              <field name= "new_comment" class="oe_edit_only" nolabel="1"/>
              <button name="save_comment" string="Agregar" type="object" class="btn btn-primary oe_edit_only" style="margin-rigth: 10px"/>
            </group>
          </group>
        
          <group attrs="{'invisible' : [('lot_id','=',False)]}">
            <group>
              <separator string="Domicilio de cobro"/>
              <field name="street_name_toll"/>
              <field name="street_number_toll"/>
              <field name="toll_municipallity_id" />
              <field name="toll_colony_id" />
              <field name="between_streets_toll" />
              <field name="phone_toll" />

              <separator string="Domicilio de casa"/>
              <field name="street_name"/>
              <field name="street_number"/>
              <field name="municipality_id" />
              <field name="neighborhood_id" />
              <field name="between_streets" />
              <field name="phone" />
            </group>

            <group string="Datos de activación">
              <field name="sale_employee_id"/>
              <field name="payment_scheme_id"/>
              <field name="lot_id" readonly="1"/>
              <field name="activation_code" readonly="1"/>
              <field name="employee_id"/>
              <field name="create_date" string="Fecha de activación" readonly="1"/>
              <field name="agent_id" string="Agente que activó" readonly="1"/>
              <field name="initial_investment" readonly="1"/>
              <field name="investment_bond" readonly="1"/>
              <field name="comments" readonly="1"/>
            </group>
          </group>
          
          <group string="Abonos" attrs="{'invisible' : [('lot_id','=',False)]}">
              <field name="payment_ids" nolabel="1" readonly="1">
                <tree default_order="date_receipt, payment_date" create="0" edit="0" delete="0" duplicate="0">
                  <field name="state" invisible="1"/>
                  <field name="date_receipt" string="Fecha recibo"/>
                  <field name="payment_date" string="Fecha oficina"/>
                  <field name="amount"/>
                  <field name="ecobro_receipt"/>
                  <field name="debt_collector_code"/>
                  <field name="reference"/>
                  <field name="state"/>
                </tree>
              </field>
          </group>

          <group string="Notas y Facturas" attrs="{'invisible' : [('lot_id','=',False)]}">
                <field name="refund_ids" nolabel="1" readonly="1">
                  <tree create="0" edit="0" delete="0" duplicate="0">
                    <field name="state" invisible="1"/>
                    <field name="invoice_date" string="Fecha oficina"/>
                    <field name="amount_total" string="Importe"/>
                    <field name="name" string="Recibo"/>
                    <field name="ref"/>
                    <field name="type"/>
                    <field name="state"/>
                  </tree>
                </field>
          </group>

          <group string="Árbol de comisiones" attrs="{'invisible' : [('lot_id','=',False)]}">
              <field name="commission_tree" nolabel="1" readonly="1"/>
          </group>

        </sheet>

        <!-- Comentarios del contrato -->
        <div class="oe_chatter">
          <field name="message_follower_ids" widget="mail_followers"/>
          <field name="activity_ids" widget="mail_activity"/>
          <field name="message_ids" widget="mail_thread"/>
        </div>
      </form>
    </field>
  </record>

  <!-- Vista de lista para Contratos -->
  <record id="contract_tree_view" model="ir.ui.view">
    <field name="name">contract.tree.view</field> 
    <field name="type">tree</field>
    <field name="model">pabs.contract</field>
    <field name="arch" type="xml">          
      <tree create="0" delete="0" >
        <field name="invoice_date"/>
        <field name="name"/>
        <field name="full_name"/>
        <field name="lot_id"/>
        <field name="street_name_toll"/>
        <field name="street_number_toll"/>
        <field name="balance"/>
        <field name="contract_status_item"/>
        <field name="contract_status_reason"/>
      </tree>
    </field>
  </record>

  <!-- Action de menú de contratos -->
  <record id="contract_action" model="ir.actions.act_window">
    <field name="name">Buscar Contrato</field>
    <field name="res_model">pabs.contract</field>
    <field name="view_mode">form</field>
    <field name="domain">[('state','=','contract')]</field>
    <field name="context">{'default_type_view' : 'contract'}</field>
    <field name="target">inline</field>
  </record>

  <!-- Action de menú de administrador -->
  <record id="action_many_contracts" model="ir.actions.act_window">
    <field name="name">Contratos (Administrador)</field>
    <field name="res_model">pabs.contract</field>
    <field name="view_mode">tree,form</field>
    <field name="domain">[('state','=','contract')]</field>
    <field name="target">current</field>
  </record>

  <record id="contract_tree_view_action" model="ir.actions.act_window.view">
    <field name="sequence" eval="1"/>
    <field name="view_mode">tree</field>
    <field name="view_id" ref="pabs_custom.contract_tree_view"/>
    <field name="act_window_id" ref="action_many_contracts"/>
  </record>

  <record id="contract_form_view_many" model="ir.actions.act_window.view">
    <field name="sequence" eval="2"/>
    <field name="view_mode">form</field>
    <field name="view_id" ref="pabs_custom.contract_form_view"/>
    <field name="act_window_id" ref="action_many_contracts"/>
  </record>

<!-- ##################################### -->
<!-- Formulario de contratos (SECRETARIA) -->
<!-- ##################################### -->
  <record id="contract_form_view_secretary" model="ir.ui.view">
    <field name="name">contract.form.view</field>
    <field name="type">form</field>
    <field name="model">pabs.contract</field>
    <field name="arch" type="xml">
       <form create="0" edit="0" delete="false" duplicate="false" >
        <header>
          <field name="captured" invisible="1"/>
          <field name="contract_status" invisible="1"/>
          <field name="allow_edit" invisible="1"/>
          <field name="state" widget="statusbar" statusbar_visible="reqactive,precontract,contract" readonly="1" invisible ="1"/>
         
        </header>
        <sheet>       
          <group attrs="{'invisible' : [('lot_id','=',False)]}"> 
            <group string="Datos del contrato" >
              <field name="name" class="oe_inline" readonly="1"/>
              <!-- attrs="{'readonly': [('allow_edit','=',False)]}" -->

              <!-- Estatus -->
              <field name="contract_status_item" required="1" options="{'no_open': True,}"/>
              <field name="contract_status_reason" domain="[('status_id', '=', contract_status_item)]" required="1" options="{'no_open': True,}"/>
              <field name="contract_status_name" invisible="1"/>
              <field name="reactivation_date" attrs="{'invisible': [('contract_status_name','!=','SUSP. TEMPORAL')], 'required': [('contract_status_name','=','SUSP. TEMPORAL')]}"/>
              <field name="date_of_last_status" readonly="1"/>
              <!-- Fin Estatus -->
              
              <field name="full_name" string="Titular"/>
              <field name="invoice_date" readonly="1"/>
              <field name="name_service" string="Nombre del plan" readonly="1" options="{'no_open': True,}"/>
              <field name="service_detail"/>
            </group>

            <group string="Datos de cobranza">
              <field name="debt_collector"/>
              <field name="way_to_payment" />
              <field name="payment_amount" />
              <field name="days_without_payment" readonly="1"/>
              <field name="late_amount"  readonly="1"/>
              <field name="date_first_payment" />
              <field name="contract_expires" readonly="1" />
              <field name="product_price" readonly="1"/> 
              <field name="balance" readonly="1"/>
              <field name="paid_balance" readonly="1"/>
            </group>
          </group>
        
          <group attrs="{'invisible' : [('lot_id','=',False)]}">
            <group>
              <separator string="Domicilio de cobro"/>
              <field name="street_name_toll"/>
              <field name="street_number_toll"/>
              <field name="toll_municipallity_id" options="{'no_open': True,}"/>
              <field name="toll_colony_id" options="{'no_open': True,}"/>
              <field name="between_streets_toll" />
              <field name="phone_toll" />

              <separator string="Domicilio de casa"/>
              <field name="street_name"/>
              <field name="street_number"/>
              <field name="municipality_id" options="{'no_open': True,}"/>
              <field name="neighborhood_id" options="{'no_open': True,}"/>
              <field name="between_streets" />
              <field name="phone" />
            </group>

            <group string="Datos de activación">
              <field name="sale_employee_id" options="{'no_open': True,}"/>
              <field name="payment_scheme_id" options="{'no_open': True,}"/>
              <field name="lot_id" readonly="1" options="{'no_open': True,}"/>
              <field name="activation_code" readonly="1"/>
              <field name="employee_id" options="{'no_open': True,}"/>
              <field name="create_date" string="Fecha de activación" readonly="1"/>
              <field name="agent_id" string="Agente que activó" readonly="1"/>
              <field name="initial_investment" readonly="1"/>
              <field name="investment_bond" readonly="1"/>
            </group>
          </group>
          
          <group string="Abonos" attrs="{'invisible' : [('lot_id','=',False)]}">
            <field name="payment_ids" nolabel="1" readonly="1" style="pointer-events:none;">
              <tree default_order="date_receipt, payment_date" create="0" edit="0" delete="0" duplicate="0">
                <field name="state" invisible="1"/>
                <field name="date_receipt" string="Fecha recibo"/>
                <field name="payment_date" string="Fecha oficina"/>
                <field name="amount"/>
                <field name="ecobro_receipt"/>
                <field name="debt_collector_code"/>
                <field name="reference"/>
                <field name="state"/>
              </tree>
            </field>
          </group>

          <group string="Notas y Facturas" attrs="{'invisible' : [('lot_id','=',False)]}">
            <field name="refund_ids" nolabel="1" readonly="1" style="pointer-events:none;">
              <tree create="0" edit="0" delete="0" duplicate="0">
                <field name="state" invisible="1"/>
                <field name="invoice_date" string="Fecha oficina"/>
                <field name="amount_total" string="Importe"/>
                <field name="name" string="Recibo"/>
                <field name="ref"/>
                <field name="type"/>
                <field name="state"/>
              </tree>
            </field>
          </group>

          <group string="Árbol de comisiones" attrs="{'invisible' : [('lot_id','=',False)]}" invisible="1">
              <field name="commission_tree" nolabel="1" readonly="1" style="pointer-events:none;"/>
          </group>

        </sheet>

        <!-- Comentarios del contrato -->
        <div class="oe_chatter">
          <field name="message_follower_ids" widget="mail_followers"/>
          <field name="activity_ids" widget="mail_activity"/>
          <field name="message_ids" widget="mail_thread"/>
        </div>
      </form>
    </field>
  </record>

  <record id="action_contract_secretary" model="ir.actions.act_window">
    <field name="name">Contratos (secretarias)</field>
    <field name="res_model">pabs.contract</field>
    <field name="view_mode">tree,form</field>
    <field name="domain">[('state','=','contract')]</field>
    <field name="target">current</field>
  </record>

  <record id="contract_tree_secretary" model="ir.actions.act_window.view">
    <field name="sequence" eval="1"/>
    <field name="view_mode">tree</field>
    <field name="view_id" ref="pabs_custom.contract_tree_view"/>
    <field name="act_window_id" ref="action_contract_secretary"/>
  </record>

  <record id="contract_form_secretary" model="ir.actions.act_window.view">
    <field name="sequence" eval="2"/>
    <field name="view_mode">form</field>
    <field name="view_id" ref="pabs_custom.contract_form_view_secretary"/>
    <field name="act_window_id" ref="action_contract_secretary"/>
  </record>
  
<!-- ####################################### -->
<!-- Formulario de contratos (CALL CENTER) -->
<!-- ####################################### -->
  <record id="contract_form_view_call" model="ir.ui.view">
    <field name="name">contract.form.view</field>
    <field name="type">form</field>
    <field name="model">pabs.contract</field>
    <field name="arch" type="xml">
       <form create="0" delete="false" duplicate="false">
        <header>
          <field name="captured" invisible="1"/>
          <field name="contract_status" invisible="1"/>
          <field name="allow_edit" invisible="1"/>
          <field name="state" widget="statusbar" statusbar_visible="reqactive,precontract,contract" readonly="1" invisible ="1"/>
         
        </header>
        <sheet>       
          <group attrs="{'invisible' : [('lot_id','=',False)]}"> 
            <group string="Datos del contrato" >
              <field name="name" class="oe_inline" readonly="1"/>
              <!-- attrs="{'readonly': [('allow_edit','=',False)]}" -->

              <!-- Estatus -->
              <field name="contract_status_item" required="1" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="contract_status_reason" domain="[('status_id', '=', contract_status_item)]" required="1" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="contract_status_name" invisible="1"/>
              <field name="reactivation_date" attrs="{'invisible': [('contract_status_name','!=','SUSP. TEMPORAL')], 'required': [('contract_status_name','=','SUSP. TEMPORAL')]}"/>
              <field name="date_of_last_status" readonly="1"/>
              <!-- Fin Estatus -->
              
              <!-- Nombre -->
              <field name="full_name" string="Titular"/>
              <!-- Fin nombre -->
              
              <field name="invoice_date" readonly="1"/>
              <field name="name_service" string="Nombre del plan" readonly="1" options="{'no_open': True,}"/>
              <field name="service_detail" readonly="1"/>
            </group>

            <group string="Datos de cobranza">
              <field name="debt_collector" domain="[('job_id','=','COBRADOR')]" readonly="1"/>
              <field name="way_to_payment" readonly="1"/>
              <field name="payment_amount" readonly="1"/>
              <field name="days_without_payment" readonly="1"/>
              <field name="late_amount"  readonly="1"/>
              <field name="date_first_payment" readonly="1"/>
              <field name="contract_expires" readonly="1"/>
              <field name="product_price" readonly="1"/> 
              <field name="balance" readonly="1"/>
              <field name="paid_balance" readonly="1"/>

              <!-- Nuevo comentario -->
              <label for="new_comment" class="oe_edit_only" /> 
              <field name= "new_comment" class="oe_edit_only" nolabel="1"/>
              <button name="save_comment" string="Agregar" type="object" class="btn btn-primary oe_edit_only" style="margin-rigth: 10px"/>
            </group>
          </group>
        
          <group attrs="{'invisible' : [('lot_id','=',False)]}">
            <group>
              <separator string="Domicilio de cobro"/>
              <field name="street_name_toll"/>
              <field name="street_number_toll"/>
              <field name="toll_municipallity_id" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="toll_colony_id" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="between_streets_toll" />
              <field name="phone_toll" />

              <separator string="Domicilio de casa"/>
              <field name="street_name"/>
              <field name="street_number"/>
              <field name="municipality_id" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="neighborhood_id" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="between_streets" />
              <field name="phone" />
            </group>

            <group string="Datos de activación">
              <field name="sale_employee_id" readonly="1" options="{'no_open': True,}"/>
              <field name="payment_scheme_id" readonly="1" options="{'no_open': True,}"/>
              <field name="lot_id" readonly="1" options="{'no_open': True,}"/>
              <field name="activation_code" readonly="1"/>
              <field name="employee_id" readonly="1" options="{'no_open': True,}"/>
              <field name="create_date" string="Fecha de activación" readonly="1"/>
              <field name="agent_id" string="Agente que activó" readonly="1"/>
              <field name="initial_investment" readonly="1"/>
              <field name="investment_bond" readonly="1"/>
              <field name="comments" readonly="1"/>
            </group>
          </group>
          
          <group string="Abonos" attrs="{'invisible' : [('lot_id','=',False)]}">
              <field name="payment_ids" nolabel="1" readonly="1" style="pointer-events:none;">
                <tree default_order="date_receipt, payment_date" create="0" edit="0" delete="0" duplicate="0">
                  <field name="state" invisible="1"/>
                  <field name="date_receipt" string="Fecha recibo"/>
                  <field name="payment_date" string="Fecha oficina"/>
                  <field name="amount"/>
                  <field name="ecobro_receipt"/>
                  <field name="debt_collector_code"/>
                  <field name="reference"/>
                  <field name="state"/>
                </tree>
              </field>
          </group>

          <group string="Notas y Facturas" attrs="{'invisible' : [('lot_id','=',False)]}">
                <field name="refund_ids" nolabel="1" readonly="1" style="pointer-events:none;">
                  <tree create="0" edit="0" delete="0" duplicate="0">
                    <field name="state" invisible="1"/>
                    <field name="invoice_date" string="Fecha oficina"/>
                    <field name="amount_total" string="Importe"/>
                    <field name="name" string="Recibo"/>
                    <field name="ref"/>
                    <field name="type"/>
                    <field name="state"/>
                  </tree>
                </field>
          </group>

          <group string="Árbol de comisiones" attrs="{'invisible' : [('lot_id','=',False)]}" invisible="1">
              <field name="commission_tree" nolabel="1" readonly="1" style="pointer-events:none;"/>
          </group>

        </sheet>

        <!-- Comentarios del contrato -->
        <div class="oe_chatter">
          <field name="message_follower_ids" widget="mail_followers"/>
          <field name="activity_ids" widget="mail_activity"/>
          <field name="message_ids" widget="mail_thread"/>
        </div>
      </form>
    </field>
  </record>

  <!-- Vista de lista para Contratos -->
  <record id="contract_tree_view_call" model="ir.ui.view">
    <field name="name">contract.tree.view</field> 
    <field name="type">tree</field>
    <field name="model">pabs.contract</field>
    <field name="arch" type="xml">          
      <tree create="0" delete="0" >
        <field name="invoice_date"/>
        <field name="name"/>
        <field name="full_name"/>
        <field name="lot_id"/>
        <field name="street_name_toll"/>
        <field name="street_number_toll"/>
        <field name="balance"/>
        <field name="contract_status_item"/>
        <field name="contract_status_reason"/>
      </tree>
    </field>
  </record>

  <!-- Action de menú -->
  <record id="action_contract_call" model="ir.actions.act_window">
    <field name="name">Contratos (Call center)</field>
    <field name="res_model">pabs.contract</field>
    <field name="view_mode">tree,form</field>
    <field name="domain">[('state','=','contract')]</field>
    <field name="target">current</field>
  </record>

  <record id="contract_tree_call" model="ir.actions.act_window.view">
    <field name="sequence" eval="1"/>
    <field name="view_mode">tree</field>
    <field name="view_id" ref="pabs_custom.contract_tree_view_call"/>
    <field name="act_window_id" ref="action_contract_call"/>
  </record>

  <record id="contract_form_call" model="ir.actions.act_window.view">
    <field name="sequence" eval="2"/>
    <field name="view_mode">form</field>
    <field name="view_id" ref="pabs_custom.contract_form_view_call"/>
    <field name="act_window_id" ref="action_contract_call"/>
  </record>

<!-- ####################################### -->
<!-- Formulario de contratos (CONTRATOS) -->
<!-- ####################################### -->
  <record id="contract_form_view_contratos" model="ir.ui.view">
    <field name="name">contract.form.view</field>
    <field name="type">form</field>
    <field name="model">pabs.contract</field>
    <field name="arch" type="xml">
       <form create="0" delete="false" duplicate="false">
        <header>
          <field name="captured" invisible="1"/>
          <field name="contract_status" invisible="1"/>
          <field name="allow_edit" invisible="1"/>
          <field name="state" widget="statusbar" statusbar_visible="reqactive,precontract,contract" readonly="1" invisible ="1"/>
         
        </header>
        <sheet>       
          <group attrs="{'invisible' : [('lot_id','=',False)]}"> 
            <group string="Datos del contrato" >
              <field name="name" class="oe_inline" readonly="1"/>
              <!-- attrs="{'readonly': [('allow_edit','=',False)]}" -->

              <!-- Estatus -->
              <field name="contract_status_item" required="1" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="contract_status_reason" domain="[('status_id', '=', contract_status_item)]" required="1" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="contract_status_name" invisible="1"/>
              <field name="reactivation_date" attrs="{'invisible': [('contract_status_name','!=','SUSP. TEMPORAL')], 'required': [('contract_status_name','=','SUSP. TEMPORAL')]}"/>
              <field name="date_of_last_status" readonly="1"/>
              <!-- Fin Estatus -->
              
              <!-- Nombre -->
              <field name="full_name" string="Titular"/>

              <label for="partner_name" string="Nuevo nombre" class="oe_edit_only" /> 
              <field name="partner_name" class="oe_edit_only" nolabel="1"/>

              <label for="partner_fname" string="Nuevo apellido paterno" class="oe_edit_only" /> 
              <field name="partner_fname" class="oe_edit_only" nolabel="1"/>

              <label for="partner_mname" string="Nuevo apellido materno" class="oe_edit_only" /> 
              <field name="partner_mname" class="oe_edit_only" nolabel="1"/>
              <!-- Fin nombre -->
              
              <field name="invoice_date" readonly="1"/>
              <field name="name_service" string="Nombre del plan" readonly="1" options="{'no_open': True,}"/>
              <field name="service_detail" readonly="1"/>
            </group>

            <group string="Datos de cobranza">
              <field name="debt_collector" domain="[('job_id','=','COBRADOR')]" readonly="1"/>
              <field name="way_to_payment"/>
              <field name="payment_amount"/>
              <field name="days_without_payment" readonly="1"/>
              <field name="late_amount"  readonly="1"/>
              <field name="date_first_payment"/>
              <field name="contract_expires" readonly="1"/>
              <field name="product_price" readonly="1"/> 
              <field name="balance" readonly="1"/>
              <field name="paid_balance" readonly="1"/>

              <!-- Nuevo comentario -->
              <label for="new_comment" class="oe_edit_only" /> 
              <field name= "new_comment" class="oe_edit_only" nolabel="1"/>
              <button name="save_comment" string="Agregar" type="object" class="btn btn-primary oe_edit_only" style="margin-rigth: 10px"/>
            </group>
          </group>
        
          <group attrs="{'invisible' : [('lot_id','=',False)]}">
            <group>
              <separator string="Domicilio de cobro"/>
              <field name="street_name_toll"/>
              <field name="street_number_toll"/>
              <field name="toll_municipallity_id" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="toll_colony_id" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="between_streets_toll" />
              <field name="phone_toll" />

              <separator string="Domicilio de casa"/>
              <field name="street_name"/>
              <field name="street_number"/>
              <field name="municipality_id" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="neighborhood_id" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="between_streets" />
              <field name="phone" />
            </group>

            <group string="Datos de activación">
              <field name="sale_employee_id" options="{'no_open': True,}"/>
              <field name="payment_scheme_id" readonly="1" options="{'no_open': True,}"/>
              <field name="lot_id" readonly="1" options="{'no_open': True,}"/>
              <field name="activation_code" readonly="1"/>
              <field name="employee_id" readonly="1" options="{'no_open': True,}"/>
              <field name="create_date" string="Fecha de activación" readonly="1"/>
              <field name="agent_id" string="Agente que activó" readonly="1"/>
              <field name="initial_investment" readonly="1"/>
              <field name="investment_bond" readonly="1"/>
              <field name="comments" readonly="1"/>
            </group>
          </group>
          
          <group string="Abonos" attrs="{'invisible' : [('lot_id','=',False)]}">
              <field name="payment_ids" nolabel="1" readonly="1">
                <tree default_order="date_receipt, payment_date" create="0" edit="0" delete="0" duplicate="0">
                  <field name="state" invisible="1"/>
                  <field name="date_receipt" string="Fecha recibo"/>
                  <field name="payment_date" string="Fecha oficina"/>
                  <field name="amount"/>
                  <field name="ecobro_receipt"/>
                  <field name="debt_collector_code"/>
                  <field name="reference"/>
                  <field name="state"/>
                </tree>
              </field>
          </group>

          <group string="Notas y Facturas" attrs="{'invisible' : [('lot_id','=',False)]}">
                <field name="refund_ids" nolabel="1" readonly="1">
                  <tree create="0" edit="0" delete="0" duplicate="0">
                    <field name="state" invisible="1"/>
                    <field name="invoice_date" string="Fecha oficina"/>
                    <field name="amount_total" string="Importe"/>
                    <field name="name" string="Recibo"/>
                    <field name="ref"/>
                    <field name="type"/>
                    <field name="state"/>
                  </tree>
                </field>
          </group>

          <group string="Árbol de comisiones" attrs="{'invisible' : [('lot_id','=',False)]}">
              <field name="commission_tree" nolabel="1" readonly="1"/>
          </group>

        </sheet>

        <!-- Comentarios del contrato -->
        <div class="oe_chatter">
          <field name="message_follower_ids" widget="mail_followers"/>
          <field name="activity_ids" widget="mail_activity"/>
          <field name="message_ids" widget="mail_thread"/>
        </div>
      </form>
    </field>
  </record>

  <!-- Vista de lista para Contratos -->
  <record id="contract_tree_view_contratos" model="ir.ui.view">
    <field name="name">contract.tree.view</field> 
    <field name="type">tree</field>
    <field name="model">pabs.contract</field>
    <field name="arch" type="xml">          
      <tree create="0" delete="0" >
        <field name="invoice_date"/>
        <field name="name"/>
        <field name="full_name"/>
        <field name="lot_id"/>
        <field name="street_name_toll"/>
        <field name="street_number_toll"/>
        <field name="balance"/>
        <field name="contract_status_item"/>
        <field name="contract_status_reason"/>
      </tree>
    </field>
  </record>

  <!-- Action de menú -->
  <record id="action_contract_contratos" model="ir.actions.act_window">
    <field name="name">Contratos (Contratos)</field>
    <field name="res_model">pabs.contract</field>
    <field name="view_mode">tree,form</field>
    <field name="domain">[('state','=','contract')]</field>
    <field name="target">current</field>
  </record>

  <record id="contract_tree_contratos" model="ir.actions.act_window.view">
    <field name="sequence" eval="1"/>
    <field name="view_mode">tree</field>
    <field name="view_id" ref="pabs_custom.contract_tree_view_contratos"/>
    <field name="act_window_id" ref="action_contract_contratos"/>
  </record>

  <record id="contract_form_contratos" model="ir.actions.act_window.view">
    <field name="sequence" eval="2"/>
    <field name="view_mode">form</field>
    <field name="view_id" ref="pabs_custom.contract_form_view_contratos"/>
    <field name="act_window_id" ref="action_contract_contratos"/>
  </record>

<!-- ####################################### -->
<!-- Formulario de contratos (Cobranza) -->
<!-- ####################################### -->
  <record id="contract_form_view_cobranza" model="ir.ui.view">
    <field name="name">contract.form.view</field>
    <field name="type">form</field>
    <field name="model">pabs.contract</field>
    <field name="arch" type="xml">
       <form create="0" delete="false" duplicate="false">
        <header>
          <field name="captured" invisible="1"/>
          <field name="contract_status" invisible="1"/>
          <field name="allow_edit" invisible="1"/>
          <field name="state" widget="statusbar" statusbar_visible="reqactive,precontract,contract" readonly="1" invisible ="1"/>
         
        </header>
        <sheet>       
          <group attrs="{'invisible' : [('lot_id','=',False)]}"> 
            <group string="Datos del contrato" >
              <field name="name" class="oe_inline" readonly="1"/>
              <!-- attrs="{'readonly': [('allow_edit','=',False)]}" -->

              <!-- Estatus -->
              <field name="contract_status_item" required="1" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="contract_status_reason" domain="[('status_id', '=', contract_status_item)]" required="1" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="contract_status_name" invisible="1"/>
              <field name="reactivation_date" attrs="{'invisible': [('contract_status_name','!=','SUSP. TEMPORAL')], 'required': [('contract_status_name','=','SUSP. TEMPORAL')]}"/>
              <field name="date_of_last_status" readonly="1"/>
              <!-- Fin Estatus -->
              
              <!-- Nombre -->
              <field name="full_name" string="Titular"/>
              <!-- Fin nombre -->
              
              <field name="invoice_date" readonly="1"/>
              <field name="name_service" string="Nombre del plan" readonly="1" options="{'no_open': True,}"/>
              <field name="service_detail" readonly="1"/>
            </group>

            <group string="Datos de cobranza">
              <field name="debt_collector" domain="[('job_id','=','COBRADOR')]"/>
              <field name="way_to_payment"/>
              <field name="payment_amount"/>
              <field name="days_without_payment" readonly="1"/>
              <field name="late_amount"  readonly="1"/>
              <field name="date_first_payment" readonly="1"/>
              <field name="contract_expires" readonly="1"/>
              <field name="product_price" readonly="1"/> 
              <field name="balance" readonly="1"/>
              <field name="paid_balance" readonly="1"/>

              <!-- Nuevo comentario -->
              <label for="new_comment" class="oe_edit_only" /> 
              <field name= "new_comment" class="oe_edit_only" nolabel="1"/>
              <button name="save_comment" string="Agregar" type="object" class="btn btn-primary oe_edit_only" style="margin-rigth: 10px"/>
            </group>
          </group>
        
          <group attrs="{'invisible' : [('lot_id','=',False)]}">
            <group>
              <separator string="Domicilio de cobro"/>
              <field name="street_name_toll"/>
              <field name="street_number_toll"/>
              <field name="toll_municipallity_id" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="toll_colony_id" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="between_streets_toll" />
              <field name="phone_toll" />

              <separator string="Domicilio de casa"/>
              <field name="street_name"/>
              <field name="street_number"/>
              <field name="municipality_id" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="neighborhood_id" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="between_streets" />
              <field name="phone" />
            </group>

            <group string="Datos de activación">
              <field name="sale_employee_id" readonly="1" options="{'no_open': True,}"/>
              <field name="payment_scheme_id" readonly="1" options="{'no_open': True,}"/>
              <field name="lot_id" readonly="1" options="{'no_open': True,}"/>
              <field name="activation_code" readonly="1"/>
              <field name="employee_id" readonly="1" options="{'no_open': True,}"/>
              <field name="create_date" string="Fecha de activación" readonly="1"/>
              <field name="agent_id" string="Agente que activó" readonly="1"/>
              <field name="initial_investment" readonly="1"/>
              <field name="investment_bond" readonly="1"/>
              <field name="comments" readonly="1"/>
            </group>
          </group>
          
          <group string="Abonos" attrs="{'invisible' : [('lot_id','=',False)]}">
              <field name="payment_ids" nolabel="1" readonly="1">
                <tree default_order="date_receipt, payment_date" create="0" edit="0" delete="0" duplicate="0">
                  <field name="state" invisible="1"/>
                  <field name="date_receipt" string="Fecha recibo"/>
                  <field name="payment_date" string="Fecha oficina"/>
                  <field name="amount"/>
                  <field name="ecobro_receipt"/>
                  <field name="debt_collector_code"/>
                  <field name="reference"/>
                  <field name="state"/>
                </tree>
              </field>
          </group>

          <group string="Notas y Facturas" attrs="{'invisible' : [('lot_id','=',False)]}">
                <field name="refund_ids" nolabel="1" readonly="1">
                  <tree create="0" edit="0" delete="0" duplicate="0">
                    <field name="state" invisible="1"/>
                    <field name="invoice_date" string="Fecha oficina"/>
                    <field name="amount_total" string="Importe"/>
                    <field name="name" string="Recibo"/>
                    <field name="ref"/>
                    <field name="type"/>
                    <field name="state"/>
                  </tree>
                </field>
          </group>

          <group string="Árbol de comisiones" attrs="{'invisible' : [('lot_id','=',False)]}">
              <field name="commission_tree" nolabel="1" readonly="1"/>
          </group>

        </sheet>

        <!-- Comentarios del contrato -->
        <div class="oe_chatter">
          <field name="message_follower_ids" widget="mail_followers"/>
          <field name="activity_ids" widget="mail_activity"/>
          <field name="message_ids" widget="mail_thread"/>
        </div>
      </form>
    </field>
  </record>

  <!-- Vista de lista para Contratos -->
  <record id="contract_tree_view_cobranza" model="ir.ui.view">
    <field name="name">contract.tree.view</field> 
    <field name="type">tree</field>
    <field name="model">pabs.contract</field>
    <field name="arch" type="xml">          
      <tree create="0" delete="0" >
        <field name="invoice_date"/>
        <field name="name"/>
        <field name="full_name"/>
        <field name="lot_id"/>
        <field name="street_name_toll"/>
        <field name="street_number_toll"/>
        <field name="balance"/>
        <field name="contract_status_item"/>
        <field name="contract_status_reason"/>
      </tree>
    </field>
  </record>

  <!-- Action de menú -->
  <record id="action_contract_cobranza" model="ir.actions.act_window">
    <field name="name">Contratos (Cobranza)</field>
    <field name="res_model">pabs.contract</field>
    <field name="view_mode">tree,form</field>
    <field name="domain">[('state','=','contract')]</field>
    <field name="target">current</field>
  </record>

  <record id="contract_tree_cobranza" model="ir.actions.act_window.view">
    <field name="sequence" eval="1"/>
    <field name="view_mode">tree</field>
    <field name="view_id" ref="pabs_custom.contract_tree_view_cobranza"/>
    <field name="act_window_id" ref="action_contract_cobranza"/>
  </record>

  <record id="contract_form_cobranza" model="ir.actions.act_window.view">
    <field name="sequence" eval="2"/>
    <field name="view_mode">form</field>
    <field name="view_id" ref="pabs_custom.contract_form_view_cobranza"/>
    <field name="act_window_id" ref="action_contract_cobranza"/>
  </record>

<!-- ####################################### -->
<!-- Formulario de contratos (Rutas) -->
<!-- ####################################### -->
  <record id="contract_form_view_rutas" model="ir.ui.view">
    <field name="name">contract.form.view</field>
    <field name="type">form</field>
    <field name="model">pabs.contract</field>
    <field name="arch" type="xml">
       <form create="0" delete="false" duplicate="false">
        <header>
          <field name="captured" invisible="1"/>
          <field name="contract_status" invisible="1"/>
          <field name="allow_edit" invisible="1"/>
          <field name="state" widget="statusbar" statusbar_visible="reqactive,precontract,contract" readonly="1" invisible ="1"/>
         
        </header>
        <sheet>       
          <group attrs="{'invisible' : [('lot_id','=',False)]}"> 
            <group string="Datos del contrato" >
              <field name="name" class="oe_inline" readonly="1"/>
              <!-- attrs="{'readonly': [('allow_edit','=',False)]}" -->

              <!-- Estatus -->
              <field name="contract_status_item" required="1" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}" readonly="1"/>
              <field name="contract_status_reason" domain="[('status_id', '=', contract_status_item)]" required="1" readonly="1" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="contract_status_name" invisible="1"/>
              <field name="reactivation_date" attrs="{'invisible': [('contract_status_name','!=','SUSP. TEMPORAL')], 'required': [('contract_status_name','=','SUSP. TEMPORAL')]}"/>
              <field name="date_of_last_status" readonly="1"/>
              <!-- Fin Estatus -->
              
              <!-- Nombre -->
              <field name="full_name" string="Titular"/>
              <!-- Fin nombre -->
              
              <field name="invoice_date" readonly="1"/>
              <field name="name_service" string="Nombre del plan" readonly="1" options="{'no_open': True,}"/>
              <field name="service_detail" readonly="1"/>
            </group>

            <group string="Datos de cobranza">
              <field name="debt_collector" domain="[('job_id','=','COBRADOR')]"/>
              <field name="way_to_payment" readonly="1"/>
              <field name="payment_amount" readonly="1"/>
              <field name="days_without_payment" readonly="1"/>
              <field name="late_amount"  readonly="1"/>
              <field name="date_first_payment" readonly="1"/>
              <field name="contract_expires" readonly="1"/>
              <field name="product_price" readonly="1"/> 
              <field name="balance" readonly="1"/>
              <field name="paid_balance" readonly="1"/>

              <!-- Nuevo comentario -->
              <label for="new_comment" class="oe_edit_only" /> 
              <field name= "new_comment" class="oe_edit_only" nolabel="1"/>
              <button name="save_comment" string="Agregar" type="object" class="btn btn-primary oe_edit_only" style="margin-rigth: 10px"/>
            </group>
          </group>
        
          <group attrs="{'invisible' : [('lot_id','=',False)]}">
            <group>
              <separator string="Domicilio de cobro"/>
              <field name="street_name_toll"/>
              <field name="street_number_toll"/>
              <field name="toll_municipallity_id" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="toll_colony_id" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="between_streets_toll" />
              <field name="phone_toll" />

              <separator string="Domicilio de casa"/>
              <field name="street_name"/>
              <field name="street_number"/>
              <field name="municipality_id" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="neighborhood_id" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="between_streets" />
              <field name="phone" />
            </group>

            <group string="Datos de activación">
              <field name="sale_employee_id" readonly="1" options="{'no_open': True,}"/>
              <field name="payment_scheme_id" readonly="1" options="{'no_open': True,}"/>
              <field name="lot_id" readonly="1" options="{'no_open': True,}"/>
              <field name="activation_code" readonly="1"/>
              <field name="employee_id" readonly="1" options="{'no_open': True,}"/>
              <field name="create_date" string="Fecha de activación" readonly="1"/>
              <field name="agent_id" string="Agente que activó" readonly="1"/>
              <field name="initial_investment" readonly="1"/>
              <field name="investment_bond" readonly="1"/>
              <field name="comments" readonly="1"/>
            </group>
          </group>
          
          <group string="Abonos" attrs="{'invisible' : [('lot_id','=',False)]}">
              <field name="payment_ids" nolabel="1" readonly="1" style="pointer-events:none;">
                <tree default_order="date_receipt, payment_date" create="0" edit="0" delete="0" duplicate="0">
                  <field name="state" invisible="1"/>
                  <field name="date_receipt" string="Fecha recibo"/>
                  <field name="payment_date" string="Fecha oficina"/>
                  <field name="amount"/>
                  <field name="ecobro_receipt"/>
                  <field name="debt_collector_code"/>
                  <field name="reference"/>
                  <field name="state"/>
                </tree>
              </field>
          </group>

          <group string="Notas y Facturas" attrs="{'invisible' : [('lot_id','=',False)]}">
                <field name="refund_ids" nolabel="1" readonly="1" style="pointer-events:none;">
                  <tree create="0" edit="0" delete="0" duplicate="0">
                    <field name="state" invisible="1"/>
                    <field name="invoice_date" string="Fecha oficina"/>
                    <field name="amount_total" string="Importe"/>
                    <field name="name" string="Recibo"/>
                    <field name="ref"/>
                    <field name="type"/>
                    <field name="state"/>
                  </tree>
                </field>
          </group>

          <group string="Árbol de comisiones" attrs="{'invisible' : [('lot_id','=',False)]}">
              <field name="commission_tree" nolabel="1" readonly="1" style="pointer-events:none;"/>
          </group>

        </sheet>

        <!-- Comentarios del contrato -->
        <div class="oe_chatter">
          <field name="message_follower_ids" widget="mail_followers"/>
          <field name="activity_ids" widget="mail_activity"/>
          <field name="message_ids" widget="mail_thread"/>
        </div>
      </form>
    </field>
  </record>

  <!-- Vista de lista para Contratos -->
  <record id="contract_tree_view_rutas" model="ir.ui.view">
    <field name="name">contract.tree.view</field> 
    <field name="type">tree</field>
    <field name="model">pabs.contract</field>
    <field name="arch" type="xml">          
      <tree create="0" delete="0" >
        <field name="invoice_date"/>
        <field name="name"/>
        <field name="full_name"/>
        <field name="lot_id"/>
        <field name="street_name_toll"/>
        <field name="street_number_toll"/>
        <field name="balance"/>
        <field name="contract_status_item"/>
        <field name="contract_status_reason"/>
      </tree>
    </field>
  </record>

  <!-- Action de menú -->
  <record id="action_contract_rutas" model="ir.actions.act_window">
    <field name="name">Contratos (Rutas)</field>
    <field name="res_model">pabs.contract</field>
    <field name="view_mode">tree,form</field>
    <field name="domain">[('state','=','contract')]</field>
    <field name="target">current</field>
  </record>

  <record id="contract_tree_rutas" model="ir.actions.act_window.view">
    <field name="sequence" eval="1"/>
    <field name="view_mode">tree</field>
    <field name="view_id" ref="pabs_custom.contract_tree_view_rutas"/>
    <field name="act_window_id" ref="action_contract_rutas"/>
  </record>

  <record id="contract_form_rutas" model="ir.actions.act_window.view">
    <field name="sequence" eval="2"/>
    <field name="view_mode">form</field>
    <field name="view_id" ref="pabs_custom.contract_form_view_rutas"/>
    <field name="act_window_id" ref="action_contract_rutas"/>
  </record>

<!-- ####################################### -->
<!-- Formulario de contratos (Gerencia) -->
<!-- ####################################### -->
  <record id="contract_form_view_gerencia" model="ir.ui.view">
    <field name="name">contract.form.view</field>
    <field name="type">form</field>
    <field name="model">pabs.contract</field>
    <field name="arch" type="xml">
       <form create="0" delete="false" duplicate="false">
        <header>
          <field name="captured" invisible="1"/>
          <field name="contract_status" invisible="1"/>
          <field name="allow_edit" invisible="1"/>
          <field name="state" widget="statusbar" statusbar_visible="reqactive,precontract,contract" readonly="1" invisible ="1"/>
         
        </header>
        <sheet>       
          <group attrs="{'invisible' : [('lot_id','=',False)]}"> 
            <group string="Datos del contrato" >
              <field name="name" class="oe_inline" readonly="1"/>
              <!-- attrs="{'readonly': [('allow_edit','=',False)]}" -->

              <!-- Estatus -->
              <field name="contract_status_item" required="1" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="contract_status_reason" domain="[('status_id', '=', contract_status_item)]" required="1" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="contract_status_name" invisible="1"/>
              <field name="reactivation_date" attrs="{'invisible': [('contract_status_name','!=','SUSP. TEMPORAL')], 'required': [('contract_status_name','=','SUSP. TEMPORAL')]}"/>
              <field name="date_of_last_status" readonly="1"/>
              <!-- Fin Estatus -->
              
              <!-- Nombre -->
              <field name="full_name" string="Titular"/>

              <label for="partner_name" string="Nuevo nombre" class="oe_edit_only" /> 
              <field name="partner_name" class="oe_edit_only" nolabel="1"/>

              <label for="partner_fname" string="Nuevo apellido paterno" class="oe_edit_only" /> 
              <field name="partner_fname" class="oe_edit_only" nolabel="1"/>

              <label for="partner_mname" string="Nuevo apellido materno" class="oe_edit_only" /> 
              <field name="partner_mname" class="oe_edit_only" nolabel="1"/>
              <!-- Fin nombre -->
              
              <field name="invoice_date" readonly="1"/>
              <field name="name_service" string="Nombre del plan" readonly="1" options="{'no_open': True,}"/>
              <field name="service_detail" readonly="1"/>
            </group>

            <group string="Datos de cobranza">
              <field name="debt_collector" domain="[('job_id','=','COBRADOR')]"/>
              <field name="way_to_payment"/>
              <field name="payment_amount"/>
              <field name="days_without_payment" readonly="1"/>
              <field name="late_amount"  readonly="1"/>
              <field name="date_first_payment"/>
              <field name="contract_expires" readonly="1"/>
              <field name="product_price" readonly="1"/> 
              <field name="balance" readonly="1"/>
              <field name="paid_balance" readonly="1"/>

              <!-- Nuevo comentario -->
              <label for="new_comment" class="oe_edit_only" /> 
              <field name= "new_comment" class="oe_edit_only" nolabel="1"/>
              <button name="save_comment" string="Agregar" type="object" class="btn btn-primary oe_edit_only" style="margin-rigth: 10px"/>
            </group>
          </group>
        
          <group attrs="{'invisible' : [('lot_id','=',False)]}">
            <group>
              <separator string="Domicilio de cobro"/>
              <field name="street_name_toll"/>
              <field name="street_number_toll"/>
              <field name="toll_municipallity_id" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="toll_colony_id" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="between_streets_toll" />
              <field name="phone_toll" />

              <separator string="Domicilio de casa"/>
              <field name="street_name"/>
              <field name="street_number"/>
              <field name="municipality_id" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="neighborhood_id" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,}"/>
              <field name="between_streets" />
              <field name="phone" />
            </group>

            <group string="Datos de activación">
              <field name="sale_employee_id" options="{'no_open': True,}" readonly="1"/>
              <field name="payment_scheme_id" readonly="1" options="{'no_open': True,}"/>
              <field name="lot_id" readonly="1" options="{'no_open': True,}"/>
              <field name="activation_code" readonly="1"/>
              <field name="employee_id" readonly="1" options="{'no_open': True,}"/>
              <field name="create_date" string="Fecha de activación" readonly="1"/>
              <field name="agent_id" string="Agente que activó" readonly="1"/>
              <field name="initial_investment" readonly="1"/>
              <field name="investment_bond" readonly="1"/>
              <field name="comments" readonly="1"/>
            </group>
          </group>
          
          <group string="Abonos" attrs="{'invisible' : [('lot_id','=',False)]}">
              <field name="payment_ids" nolabel="1" readonly="1">
                <tree default_order="date_receipt, payment_date" create="0" edit="0" delete="0" duplicate="0">
                  <field name="state" invisible="1"/>
                  <field name="date_receipt" string="Fecha recibo"/>
                  <field name="payment_date" string="Fecha oficina"/>
                  <field name="amount"/>
                  <field name="ecobro_receipt"/>
                  <field name="debt_collector_code"/>
                  <field name="reference"/>
                  <field name="state"/>
                </tree>
              </field>
          </group>

          <group string="Notas y Facturas" attrs="{'invisible' : [('lot_id','=',False)]}">
                <field name="refund_ids" nolabel="1" readonly="1">
                  <tree create="0" edit="0" delete="0" duplicate="0">
                    <field name="state" invisible="1"/>
                    <field name="invoice_date" string="Fecha oficina"/>
                    <field name="amount_total" string="Importe"/>
                    <field name="name" string="Recibo"/>
                    <field name="ref"/>
                    <field name="type"/>
                    <field name="state"/>
                  </tree>
                </field>
          </group>

          <group string="Árbol de comisiones" attrs="{'invisible' : [('lot_id','=',False)]}">
              <field name="commission_tree" nolabel="1" readonly="1"/>
          </group>

        </sheet>

        <!-- Comentarios del contrato -->
        <div class="oe_chatter">
          <field name="message_follower_ids" widget="mail_followers"/>
          <field name="activity_ids" widget="mail_activity"/>
          <field name="message_ids" widget="mail_thread"/>
        </div>
      </form>
    </field>
  </record>

  <!-- Vista de lista para Contratos -->
  <record id="contract_tree_view_gerencia" model="ir.ui.view">
    <field name="name">contract.tree.view</field> 
    <field name="type">tree</field>
    <field name="model">pabs.contract</field>
    <field name="arch" type="xml">          
      <tree create="0" delete="0" >
        <field name="invoice_date"/>
        <field name="name"/>
        <field name="full_name"/>
        <field name="lot_id"/>
        <field name="street_name_toll"/>
        <field name="street_number_toll"/>
        <field name="balance"/>
        <field name="contract_status_item"/>
        <field name="contract_status_reason"/>
      </tree>
    </field>
  </record>

  <!-- Action de menú -->
  <record id="action_contract_gerencia" model="ir.actions.act_window">
    <field name="name">Contratos (Gerencia)</field>
    <field name="res_model">pabs.contract</field>
    <field name="view_mode">tree,form</field>
    <field name="domain">[('state','=','contract')]</field>
    <field name="target">current</field>
  </record>

  <record id="contract_tree_gerencia" model="ir.actions.act_window.view">
    <field name="sequence" eval="1"/>
    <field name="view_mode">tree</field>
    <field name="view_id" ref="pabs_custom.contract_tree_view_gerencia"/>
    <field name="act_window_id" ref="action_contract_gerencia"/>
  </record>

  <record id="contract_form_gerencia" model="ir.actions.act_window.view">
    <field name="sequence" eval="2"/>
    <field name="view_mode">form</field>
    <field name="view_id" ref="pabs_custom.contract_form_view_gerencia"/>
    <field name="act_window_id" ref="action_contract_gerencia"/>
  </record>

  <record id="contract_search_view" model="ir.ui.view" >
    <field name="name">contract.search.view</field>
    <field name="model">pabs.contract</field>
    <field name="arch" type="xml">
        <search>
            <field name="name" string="Contrato"/>

            <field name="partner_name" string="Nombre"/>
            <field name="partner_fname" string="Apellido paterno"/>
            <field name="partner_mname" string="Apellido materno"/>
            
            <field name="lot_id" string="Solicitud"/>
            <field name="street_name" string="Calle de casa"/>
            <field name="street_name_toll" string="Calle de cobro"/>
            <field name="activation_code" string="Clave de activación"/>
            
        </search>
    </field>
  </record>
  

<!-- Fin formularios de contrato -->
</odoo>
