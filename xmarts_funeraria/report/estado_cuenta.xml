<?xml version="1.0"?>
<odoo>
	<data>
    	<template id="xmarts_funeraria.estado_cuenta">
        <t t-call="web.html_container">

          <t t-call="web.basic_layout">
          <t t-foreach="docs" t-as="doc">

              <div class="header">
                <table width="100%" cellspacing="0" cellpadding="0">
                  <tr>
                    <td width="20%" rowspan="2" aling="top">
                      <img src="xmarts_funeraria/static/description/image.png" style="width:250px;" />
                    </td>
                    <td  class="text-center" aling="top">
                      <h3><strong>PABS - Programa de Apoyo De Beneficio Social <br/><br/>ESTADO DE CUENTA</strong></h3>
                    </td>
                    <td width="20%" rowspan="2" aling="top">
                    </td>
                  </tr>
                </table>
              </div>

              <div class="page">
                <br/><br/><br/><br/><br/><br/><br/>
                <table width="100%">
                  <tr>
                    <td width="7%"><ins><strong>Contrato:</strong></ins></td>
                    <td><t t-esc="doc.name"/></td>
                    <td class="text-right" width="20%"><ins><strong>Fecha contrato:</strong></ins><span>&amp;nbsp;&amp;nbsp;</span></td>
                    <td><t t-esc="doc.create_date" t-options='{"widget": "date"}'/></td>
                    <td class="text-right" width="20%"><ins><strong>Solicitud:</strong></ins><span>&amp;nbsp;&amp;nbsp;</span></td>
                    <td><t t-esc="doc.lot_id.name"/></td>
                    <td class="text-right" width="20%"><ins><strong>Costo:</strong></ins><span>&amp;nbsp;&amp;nbsp;</span></td>
                    <td><t t-esc="doc.product_price"/></td>
                    <td class="text-right" width="20%"><ins><strong>Saldo:</strong></ins><span>&amp;nbsp;&amp;nbsp;</span></td>
                    <td><t t-esc="doc.balance"/></td>
                  </tr>
                </table>

                <table width="100%">
                  <tr>
                    <td width="7%"><ins><strong>Cliente:</strong></ins></td>
                    <td width="30%"><t t-esc="doc.full_name"/></td>
                    <td width="7%"><ins><strong>Telefono:</strong></ins><span>&amp;nbsp;&amp;nbsp;</span></td>
                    <td width="15%"><t t-esc="doc.phone"/></td>
                  </tr>
                  <tr>
                    <td><ins><strong>Colonia:</strong></ins></td>
                    <td><t t-esc="doc.neighborhood_id.name"/></td>
                    <td><ins><strong>Localidad:</strong></ins><span>&amp;nbsp;&amp;nbsp;</span></td>
                    <td><t t-esc="doc.municipality_id.name"/></td>
                  </tr>
                  <tr>
                    <td><ins><strong>Domicilio:</strong></ins></td>
                    <td><t t-esc="doc.street_toll"/></td>
                    <td colspan="2"><ins><strong>Importe de Pago Actual:</strong></ins><span>&amp;nbsp;&amp;nbsp;</span></td>
                    <td><t t-esc="doc.payment_amount"/></td>
                  </tr>
                  <tr>
                    <td colspan="2"></td>
                    <td colspan="2"><ins><strong>Código Activación:</strong></ins><span>&amp;nbsp;&amp;nbsp;</span></td>
                    <td><t t-esc="doc.activation_code"/></td>
                  </tr>
                </table><br/>

                <table width="100%">
                  <thead>
                    <tr>
                      <th class="text-center" style="width: 20%; border: none; border-bottom: 1px solid black;">Fecha de recibo</th>
                      <th class="text-center" style="width: 15%; border: none; border-bottom: 1px solid black;">Recibo</th>
                      <th class="text-center" style="width: 20%; border: none; border-bottom: 1px solid black;">Importe</th>
                      <th class="text-center" style="width: 25%; border: none; border-bottom: 1px solid black;">Cobrador</th>
                      <th class="text-center" style="width: 20%; border: none; border-bottom: 1px solid black;">Movimiento</th>
                    </tr>
                  </thead>
                  <tbody>
                      <t t-set="ids" t-value="doc.id"/>
                      <t t-set="pay" t-value="doc.payments(ids)"/>
                    <t t-foreach="pay" t-as="d">

                    <tr>
                      <td class="text-center"><span/><t t-esc="d['payment_date']"/></td>
                      <td class="text-center"><span/><t t-esc="d['Ecobro_receipt']"/></td>
                      <td class="text-center"><span><t t-esc="d['amount']"/></span></td>
                      <td class="text-center"><span/><t t-esc="d['debt_collector_code']"/></td>
                      <td class="text-center">
                        <span t-if="d['reference'] == 'payment'">Abono</span>
                        <span t-if="d['reference'] == 'stationary'">Papeleria</span>
                        <span t-if="d['reference'] == 'surplus'">Excelencia</span>
                      </td>
                    </tr>
                 
                  </t>
                  </tbody>
                </table><br/>

                <table width="60%">
                  <tr>
                    <td width="20%"><strong>Días sin Abonar:</strong></td>
                    <td>391</td>
                    <td><strong>Estatus:</strong></td>
                    <td>INACTIVO</td>
                  </tr>
                  <tr>
                    <td><strong>Monto Atrasado:</strong></td>
                    <td>6300</td>
                    <td><strong>Motivo:</strong></td>
                    <td>SUSPENSIÓN PARA CANCELAR</td>
                  </tr>
                </table>

                <table width="60%">
                  <tr>
                    <td width="10%"><strong>Servicio:</strong></td>
                    <td>2CJ PREMIUM</td>
                  </tr>
                  <tr>
                    <td><strong>Ataud:</strong></td>
                    <td>PREMIUM</td>
                  </tr>
                </table>

              </div>

            </t>
          </t>
        </t>
    	</template>

  </data>

	<record id="paperformat_estado_cuenta" model="report.paperformat">
    <field name="name">PF Sale Order Portrait</field>
    <field name="default" eval="True"/>
    <field name="format">A4</field>
    <field name="page_height">0</field>
    <field name="page_width">0</field>
    <field name="orientation">Portrait</field>
    <field name="margin_top">10</field>
    <field name="margin_bottom">15</field>
    <field name="margin_left">7</field>
    <field name="margin_right">7</field>
    <field name="header_line" eval="False"/>
    <field name="header_spacing">3</field>
    <field name="dpi">130</field>
 </record>


 <report
    string="Edo. Cuenta"
    id="id_estado_cuenta"
    model='pabs.contract'
    name="xmarts_funeraria.estado_cuenta"
    file="xmarts_funeraria.estado_cuenta"
    report_type="qweb-pdf"
    print_report_name="'Estado de cuenta'"
    paperformat="xmarts_funeraria.paperformat_estado_cuenta"
  />


</odoo>
